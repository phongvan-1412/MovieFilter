@{
    ViewBag.Title = "Read";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";


    MovieFilterSp.Models.movie movie = new MovieFilterSp.Models.movie();
    var countries = (List<MovieFilterSp.Models.country>)ViewData["lstCountries"];
    var languages = (List<MovieFilterSp.Models.language>)ViewData["lstLanguages"];
    var hours = (List<int>)ViewData["lstHour"];
    var minutes = (List<Int64>)ViewData["lstMinute"];
    var years = (List<int>)ViewData["lstYears"];
    var actors = (List<MovieFilterSp.Models.actor>)ViewData["lstActors"];
    var directors = (List<MovieFilterSp.Models.director>)ViewData["lstDirectors"];
    var genres = (List<MovieFilterSp.Models.genre>)ViewData["lstGenres"];
}

<h2>List of Movies</h2>
<div class="row mt-5">
    <div class="col-md-12">
        <div class="row text-white mb-5">
            <form action="Read" method="get">
                <div class="mb-3">
                    <input placeholder="Search..."
                           style="width: 300px; height: 35px; background: transparent; border: 1px solid white; border-radius: 10px; padding-left: 10px;"
                           name="searchString" />
                </div>


                <div class="d-flex mb-4">
                    <div class="me-5">
                        <label class="fw-bold me-3" style="color: #0d6efd">Order</label>
                        <select id="selOrder" name="order" placeholder="Select Order">
                            <option selected disabled>Select Order</option>
                            <option value="5">Ascending</option>
                            <option value="6">Descending</option>
                        </select>
                    </div>

                    <div class="me-5">
                        <label class="fw-bold me-3" style="color: #0d6efd">Year</label>
                        <select id="selYear" name="year" placeholder="Select Year">
                            <option selected disabled>Select Year</option>
                            <option>Before 1998</option>
                            <option>Between 1990-2000</option>
                            @foreach (var item in years)
                            {
                                <option>@item</option>
                            }
                        </select>
                    </div>

                    <div class="me-3">
                        <div class="d-flex me-3 mb-2">
                            <div class="me-3">
                                <label class="fw-bold me-3" style="color: #0d6efd">Actor</label>
                                <select id="selActor" name="actor" placeholder="Select Actor" data-search="true" data-silent-initial-value-set="true">
                                    <option selected disabled>Select</option>
                                    @foreach (var item in actors as List<MovieFilterSp.Models.actor>)
                                    {
                                        <option>@item.act_fullname</option>
                                    }
                                </select>
                            </div>
                            <div class="d-flex flex-column align-items-center float-start">
                                <label class="fw-bold me-3" style="color: #0d6efd">Directed</label>
                                <input name="directed" type="checkbox" />
                            </div>
                        </div>


                        <div class="d-flex mb-2">
                            <div>
                                <label class="fw-bold me-3" style="font-size: 12px; color: #0d6efd">Act FName</label>
                                <select id="selActFName" name="actFName" placeholder="Select FName" data-search="true" data-silent-initial-value-set="true">
                                    <option selected disabled>Select</option>
                                    @foreach (var item in actors as List<MovieFilterSp.Models.actor>)
                                    {
                                        <option>@item.act_fname</option>
                                    }
                                </select>
                            </div>

                            <div>
                                <label class="fw-bold me-3" style="font-size: 12px; color: #0d6efd">Act LName</label>
                                <select id="selActLName" name="actLName" placeholder="Select LName" data-search="true" data-silent-initial-value-set="true">
                                    <option selected disabled>Select</option>
                                    @foreach (var item in actors as List<MovieFilterSp.Models.actor>)
                                    {
                                        <option>@item.act_lname</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="me-3">
                        <div class="d-flex me-3 mb-2">
                            <div class="me-3">
                                <label class="fw-bold me-3" style="color: #0d6efd">Director</label>
                                <select id="selDirectors" name="director" placeholder="Select Director" data-search="true" data-silent-initial-value-set="true">
                                    <option selected disabled>Select</option>
                                    @foreach (var item in directors as List<MovieFilterSp.Models.director>)
                                    {
                                        <option>@item.dir_fullname</option>
                                    }
                                </select>
                            </div>

                            <div class="d-flex flex-column align-items-center">
                                <label class="fw-bold me-3" style="color: #0d6efd">Has roled</label>
                                <input name="hasRole" type="checkbox" />
                            </div>
                        </div>

                        <div class="d-flex mb-2">
                            <div class="me-3">
                                <label class="fw-bold me-3" style="font-size: 12px; color: #0d6efd">Dir FName</label>
                                <select id="selDirFName" name="firstName" placeholder="Select FName" data-search="true" data-silent-initial-value-set="true">
                                    <option selected disabled>Select</option>
                                    @foreach (var item in directors as List<MovieFilterSp.Models.director>)
                                    {
                                        <option>@item.dir_fname</option>
                                    }
                                </select>
                            </div>

                            <div>
                                <label class="fw-bold me-3" style="font-size: 12px; color: #0d6efd">Dir LName</label>
                                <select id="selDirLName" name="lastName" placeholder="Select LName" data-search="true" data-silent-initial-value-set="true">
                                    <option selected disabled>Select</option>
                                    @foreach (var item in directors as List<MovieFilterSp.Models.director>)
                                    {
                                        <option>@item.dir_lname</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <hr class="mt-3 mb-3" style="color: #0d6efd" />

                <div class="d-flex mb-3">
                    <div class="me-3">
                        <div class="d-flex flex-column me-5 mb-2">
                            <label class="fw-bold" style="color: #0d6efd">Countries</label>
                            <select id="selCountry" name="country" placeholder="Select Country" data-search="true" data-silent-initial-value-set="true">
                                <option selected disabled>Select</option>
                                @foreach (var item in countries as List<MovieFilterSp.Models.country>)
                                {
                                    <option>@item.name</option>
                                }
                            </select>
                        </div>

                        <div class="d-flex flex-column me-5 mb-2">
                            <label class="fw-bold" style="color: #0d6efd">Without</label>
                            <select id="selXCountry" name="xCountry" placeholder="Select Country" data-search="true" data-silent-initial-value-set="true">
                                <option selected disabled>Select</option>
                                @foreach (var item in countries as List<MovieFilterSp.Models.country>)
                                {
                                    <option>@item.name</option>
                                }
                            </select>
                        </div>
                    </div>

                    <div class="d-flex flex-column me-5 mb-2">
                        <label class="fw-bold" style="color: #0d6efd">Language</label>
                        <select id="selLang" name="lang" placeholder="Select Language" data-search="true" data-silent-initial-value-set="true">
                            <option selected disabled>Select</option>
                            @foreach (var item in languages as List<MovieFilterSp.Models.language>)
                            {
                                <option>@item.name</option>
                            }
                        </select>
                    </div>

                    <div class="d-flex flex-column me-5 mb-2">
                        <label class="fw-bold" style="color: #0d6efd">Rating</label>
                        <select id="selRating" name="rating" placeholder="Select Rating" data-search="true" data-silent-initial-value-set="true">
                            <option selected disabled>Select</option>
                            <option value="7">None Rating</option>
                            <option value="18">Rating</option>
                            <option value="8">At least 3 stars</option>
                            <option value="17">3 stars or 4 stars</option>
                            <option value="11">Highest stars</option>
                            <option value="19">Highest rating</option>
                            <option value="12">Lowest rating</option>
                        </select>
                    </div>

                    <div class="d-flex flex-column me-5 mb-2">
                        <label class="fw-bold" style="color: #0d6efd">Reviewer</label>
                        <select id="selReviewer" name="reviewer" placeholder="Select Reviewer" data-search="true" data-silent-initial-value-set="true">
                            <option selected disabled>Select</option>
                            <option value="9">User</option>
                            <option value="10">Anonymous</option>
                        </select>
                    </div>

                    <div class="d-flex flex-column me-5 mb-2">
                        <label class="fw-bold" style="color: #0d6efd">Genre</label>
                        <select id="selGenres" name="genre" multiple placeholder="Select Genre" data-search="true" data-silent-initial-value-set="true">
                            <option selected disabled>Select</option>
                            @foreach (var item in genres)
                            {
                                <option>
                                    @item.gen_title
                                </option>
                            }
                        </select>
                    </div>

                    <div class="d-flex flex-column me-5 mb-2">
                        <label class="fw-bold" style="color: #0d6efd">Duration</label>
                        <select id="selDuration" name="duration" placeholder="Select" data-search="true" data-silent-initial-value-set="true">
                            <option selected disabled>Select Duration</option>
                            <option value="15">Shortest</option>
                            <option value="16">Longest</option>
                        </select>
                    </div>
                </div>

                
                <button type="submit" class="btn btn-primary text-white me-3">Search</button>
            </form>

        </div>

        <div class="row">
            @*@if (TempData["searchFlag"] != null)
            {
                <div class="form-group alert alert-danger mb-3">
                    <strong>@TempData["searchFlag"]</strong>
                </div>
            }*@
        </div>

        <table class="table text-white">
            <thead class="table-primary">
                <tr>
                    <th class="align-middle p-2">Index</th>
                    <th class="align-middle p-2">Title</th>
                    <th class="align-middle p-2">Actor</th>
                    <th class="align-middle p-2">Role</th>
                    <th class="align-middle p-2">Director</th>
                    <th class="align-middle p-2">Genre</th>
                    <th class="align-middle p-2">Year</th>
                    <th class="align-middle p-2">Release Date</th>
                    <th class="align-middle p-2">Duration</th>
                    <th class="align-middle p-2">Language</th>
                    <th class="align-middle p-2">Country</th>
                    <th class="align-middle p-2">Rating & Viewing</th>
                    <th class="align-middle p-2">Action</th>
                </tr>
            </thead>

            <tbody class="text-white">
                @*@foreach (var item in Model as List<MovieFilterSp.Models.movie>)
                {
                    <tr>
                        <td class="align-middle p-2" style="margin-right: 1rem">
                            @{
                                var index = Model.IndexOf(item) + 1;
                            }@index
                        </td>
                        <td class="align-middle p-2">@item.mov_title</td>

                        <td class="align-middle">
                            <ul class="p-0" style="list-style-type: none">
                                @foreach (var i in item.movie_cast)
                                {
                                    <li class="p-0 mt-2">
                                        @{
                                            var service = new MovieFilterSp.Service.ServiceClient();
                                            var actName = service.GetActorById(i.act_id).act_fullname;
                                        }-@actName

                                    </li>
                                }
                                <li class="p-0 mt-5">@Html.Partial("~/Areas/Admin/Views/Movie/UpdateActor.cshtml", item.movie_cast)</li>
                            </ul>
                        </td>

                        <td class="align-middle">
                            <ul class="p-0" style="list-style-type: none">
                                @foreach (var i in item.movie_cast)
                                {
                                    <li class="p-0 mt-2">-@i.role</li>
                                }
                                <li class="p-0 mt-5">@Html.Partial("~/Areas/Admin/Views/Movie/UpdateRole.cshtml", item.movie_cast)</li>
                            </ul>
                        </td>

                        <td class="align-middle">
                            <ul class="p-0" style="list-style-type: none">
                                @foreach (var i in item.movie_direction)
                                {
                                    <li class="p-0 mt-2">
                                        @{
                                            var service = new MovieFilterSp.Service.ServiceClient();
                                            var dirName = service.GetDirectorById(i.dir_id).dir_fullname;
                                        }-@dirName
                                    </li>
                                }
                                <li class="p-0 mt-5">@Html.Partial("~/Areas/Admin/Views/Movie/UpdateDirector.cshtml", item.movie_cast)</li>
                            </ul>
                        </td>

                        <td class="align-middle">
                            <ul class="p-0" style="list-style-type: none">
                                @foreach (var i in item.movie_genres)
                                {
                                    <li class="p-0">
                                        @{
                                            var service = new MovieFilterSp.Service.ServiceClient();
                                            var genName = service.GetGenreById(i.gen_id).gen_title;
                                        }-@genName
                                    </li>
                                }
                                <li class="p-0 mt-5">@Html.Partial("~/Areas/Admin/Views/Movie/UpdateRole.cshtml", item.movie_cast)</li>
                            </ul>
                        </td>

                        <td class="align-middle p-2">@item.mov_year</td>
                        <td class="align-middle p-2">@item.mov_dt_rel</td>
                        <td class="align-middle p-2">@item.mov_time</td>
                        <td class="align-middle p-2">@item.mov_lang</td>
                        <td class="align-middle p-2">@item.mov_rel_country</td>
                        <td class="align-middle p-2">
                            @Html.Partial("~/Areas/Admin/Views/Movie/RatingDetail.cshtml", item)

                        </td>
                        <td class="align-middle p-2">
                            @Html.Partial("~/Areas/Admin/Views/Movie/Update.cshtml", item)
                        </td>
                    </tr>
                }*@
            </tbody>
        </table>
    </div>
</div>

<div class="col-md-12">
    @Html.Partial("~/Areas/Admin/Views/Movie/Create.cshtml", movie)
</div>

<link href="~/Content/virtual-select.min.css" rel="stylesheet" />
<script type="text/javascript" src="~/Scripts/virtual-select.min.js"></script>
<script type="text/javascript">
    VirtualSelect.init({
        ele: '#selOrder',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selYear',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selCountry',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selXCountry',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selLang',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selDirectors',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selDirFName',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selDirLName',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selActor',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selActFName',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selActLName',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selRating',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selReviewer',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });

    VirtualSelect.init({
        ele: '#selGenres',
        autoSelectFirstOption: false,
        maxWidth: "150px"
    });

    VirtualSelect.init({
        ele: '#selDuration',
        autoSelectFirstOption: false,
        maxWidth: "160px"
    });
</script>


